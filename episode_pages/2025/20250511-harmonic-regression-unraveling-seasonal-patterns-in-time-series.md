# Harmonic Regression: Unraveling Seasonal Patterns in Time Series

**Published:** May 11, 2025  
**Duration:** 17m 1s  
**Episode ID:** 17692724

ðŸŽ§ **[Listen to this episode](https://intellectuallycurious.buzzsprout.com/2529712/episodes/17692724-harmonic-regression-unraveling-seasonal-patterns-in-time-series)**

## Description

On The Deep Dive, we tackle harmonic regressionâ€”the art of decomposing time-series seasonality with sine and cosine terms. Weâ€™ll walk through the linear regression setup, how to add trends or adapt to count data via GLMs, and how the method can capture annual, quarterly, or daily cycles. Finally, we discuss its limitsâ€”namely the symmetric shapeâ€”and look at practical fixes like two-step extensions to model sharp peaks, with examples from epidemiology, finance, and environmental science.

## Transcript

Welcome to The Deep Dive. Today we're tackling harmonic regression. This is a really powerful technique for understanding those repeating seasonal patterns you see everywhere in time series data. Stock markets maybe or epidemiological trends? Absolutely. These recurring cycles, the seasonality, it's fundamental in so many areas. Yeah, exactly. And being able to spot it and more importantly model it effectively, well, that's just crucial for analyzing data that changes over time. Right. Whether you're in business trying to predict sales dips and peaks or in healthcare tracking disease outbreaks or even say environmental science looking at ecological cycles. Understanding these rhythms is, well, it's vital. It really is. It helps you make informed decisions. And that's exactly why we're diving into harmonic regression today. We've pulled together some interesting sources, statistical analyses, detailed methods from journals like the International Journal of Environmental Research and Public Health, even some software documentation. Good stuff. Our goal really is to give you a solid handle on this technique, show you its power for analysis. And it's quite elegant actually. At its heart, harmonic regression uses those fundamental sine and cosine waves, you know, the basic oscillations we see all through mathematics to break down these sometimes complex looking seasonal patterns. Yeah, it helps sort of dissect them into predictable bits. Exactly. Into understandable components. Okay, so let's start right at the core then. What's the basic mathematical model look like? Okay, so the fundamental harmonic regression model, we usually write it as Zt equals A cos 2 pi plus B plus et. Whoa, okay. Let's unpack that a bit. Zt, that's just the data point at time t. Correct. The value of your series at a specific time t, then that's your baseline level. Think of it as the average the data is fluctuating around. So like for monthly shop sales would be this sort of average sales figure if there were no seasonal peaks or troughs. Precisely, yeah. Then you've got duce gamma, that's the amplitude. Amplitude, how big the swing is. Exactly. The intensity of the seasonal variation, how high the peaks are, how low the troughs are relative to that baseline. Okay. Then omega, that's the frequency of the oscillation. This is directly linked to the period of a season. So for monthly data with an annual cycle is 1 twelfth. One cycle per 12 months. Right, because the cycle repeats every 12 time units. Makes sense. Then t is just our time index. And phi, that's the phase angle. Phase angle, what does that control? That determines the timing. It pinpoints when the peak occurs within that cycle. It essentially shifts the cosine wave left or right along the time axis. Okay, so it lines up the mathematical wave with the actual peak in the data. Exactly. And finally, epsilon t, that's just the error term. It's the bit of the data that our nice smooth wave model doesn't perfectly capture. The noise, essentially. Right, the random variation or factors not included. So this model gives us a smooth, regular wave. But the sources mentioned another way to write it, one that's better for actually doing the calculations. Ah, yes. For estimation, for actually fitting the model to data, it's often more convenient to rewrite it using both sine and cosine, like this. Zt equals 1 plus Zt sin 2 pi plus Zt cos 2 pi plus et. Okay, so now we have a betas and a mixi instead of the gamma and phi. Exactly. Zt and zt are the coefficients we estimate using standard regression techniques. They neatly combine the information about the amplitude and the phase angle from the first form. How do they relate back? Well, you can calculate the amplitude arc as the square root of the t's squared plus zt's squared, and the phase angle is related to the arctangent of betas divided by betas. I see. And the benefit is? The big benefit is that this second form is linear in terms of the parameters we need to estimate, betas and betas. That means we can use standard, well-understood linear regression methods to find their values, which is much easier computationally than directly estimating bits of fit in the first non-linear form. Ah, okay. That is much more practical, isn't it? You estimate the betas using standard tools, and then you can just calculate the amplitude and phase if you need them. Very neat. It is. It simplifies the fitting process considerably. Now, you mentioned O is 112 for monthly data with an annual cycle. Yeah. How does that change for, say, quarterly or daily data? Good question. The principle is the same. For quarterly data with an annual cycle, there are four quarters in the cycle, so O would be 14. One cycle every four quarters, yep. For weekly data, it gets a little messier because a year isn't exactly 52 weeks. It's about 52.25 weeks. So O is roughly 1 divided by 52.25. Okay. And for daily data, again, accounting for leap years, the average year is about 365.25 days, so O would be approximately 1 divided by 365.25 for an annual pattern. So the key is always one over the number of time units in one full seasonal cycle. Precisely. It defines how quickly the sine and cosine functions complete a full oscillation relative to your time unit. Okay, that clarifies the frequency part. Now, real-world data often isn't just oscillating around a flat average, is it? You often see trends that things generally increasing or decreasing over time. Can harmonic regression handle that too? Oh, absolutely. That's one of its strengths. You can easily extend the basic model to include trend components. How would that look? Well, imagine you have monthly data like before with that annual seasonality, but you also see a steady increase over several years. A common way to model that would be something like Zt plus Bcc cos 2Ï€t12 plus Bc 2Ï€t12 plus BrA plus Bt. Well, let's break that one down. Zr is still the baseline, but maybe the baseline at the very start. Yeah, the intercept term, effectively the baseline at time zero. Then the sine and cosine terms are the same as before, capturing the monthly wiggles within each year. Here, t means the month within year e. That's right, indexing the month. And the new part is ByrE. So i's is the year number, like year one, year two, year three. Correct, the year index. And Byr is the coefficient telling us how much the baseline level changes each year, the slope of the trend. Exactly. It quantifies the magnitude and direction of that linear trend over the years. So this model lets you estimate both the repeating seasonal pattern and the overall upward or downward drift simultaneously. That's really useful. And the sources also mentioned adapting this for different kinds of data, like counts. Yes, the framework is flexible. If your data isn't normally distributed, say you're counting events like disease cases, which often follow a Poisson distribution, you can embed this harmonic structure within a generalized linear model, or GLM. Using something like a log link function. Typically, yes. A log link is common for Poisson regression. The core idea of using sine and cosine terms to model the seasonality remains the same, but you fit it within the appropriate statistical framework for your data type. So you can disentangle seasonality and trend for various types of data. That's quite powerful, but there was a limitation mentioned. The basic sine and cosine wave is symmetrical, right? Smooth up, smooth down. That's a very important point. Yes, the standard harmonic model assumes a symmetric seasonal pattern. What happens when that's not realistic? I'm thinking, like, maybe flu season cases. They shoot up fast, maybe trail off slower. Exactly the kind of scenario. Real-world seasonality isn't always symmetrical. Flu seasons, certain retail peaks, maybe agricultural cycles, they can have sharp, rapid increases to a peak, followed by a more gradual decline, or vice versa. A standard harmonic regression might struggle to capture the shape, and, critically, the exact height and timing of those sharp peaks accurately. It tends to smooth them out. So how do we get around that? How can we adapt the model for these spikier patterns? Researchers have come up with some clever ways. A common strategy involves a two-step procedure. Okay, step one. Step one is usually to fit a basic harmonic regression model, maybe just the first harmonic sine and cosine pair, primarily to get an initial estimate of the timing of the seasonal peak. Let's call this estimated peak time, theta. So first, find roughly when the peak usually happens. Got it. Step two. Step two involves fitting an extended model. This model uses modified sine and cosine functions, transformations of the basic ones. These transformations are specifically designed to create an asymmetrical shape around that estimated peak time out. How do they do that? They often incorporate terms that behave a bit like a quadratic function near the peak, allowing for a sharper rise or fall. They might use time variables shifted relative to A, or functions that change behavior depending on whether you're before or after the estimated peak time. So it kind of warps the standard wave shape to match the data better. That's a good way to think about it. Model C and D mentioned in some of the research papers are examples of these extended forms. They use specific mathematical transformations involving door and time-shifted variables to mimic that sharp peak and allow the amplitude to vary more realistically around the peak season. So you can tailor the wave shape, in a sense. It's impressive how you can build that complexity onto the basic sine and cosine foundation. It really is. It shows the flexibility of the approach. And the research you looked at used these techniques on real data, right? Can you give us a couple of examples

---
*This episode was generated from the Intellectually Curious Podcast. For more episodes, visit our [main site](https://intellectuallycurious.buzzsprout.com).*
