# OEIS A00023: Sphere lattice-point error in a 3D ball

**Published:** May 15, 2025  
**Duration:** 12m 7s  
**Episode ID:** 17692793

ðŸŽ§ **[Listen to this episode](https://intellectuallycurious.buzzsprout.com/2529712/episodes/17692793-oeis-a00023-sphere-lattice-point-error-in-a-3d-ball)**

## Description

In this episode we explore the classic problem of counting lattice points inside a three-dimensional sphere and how that count deviates from the smooth volume. Define A_N as the number of integer triples i, j, k with i^2 + j^2 + k^2 â‰¤ N, and compare it to the sphereâ€™s volume V_N. The difference P_N = A_N âˆ’ V_N is the lattice-point error term. Weâ€™ll connect this to the 2D Gauss circle problem, discuss what A00092 reveals about record-high errors, and outline the analytic tools that drive current boundsâ€”harmonic analysis, exponential sums, and smoothing tricks. Weâ€™ll also glimpse higher-dimensional generalizations and what these fluctuations say about how a discrete grid fills continuous space.

## Transcript

Welcome to The Deep Dive. We're carrying on with our series looking into the OEIS, the Online Encyclopedia of Integer Sequences. And this time we're hitting a topic that, well, it really connects geometry and number theory in a, I think, a pretty beautiful way. Yes, exactly. We're looking at OEIS sequence A00023, and it comes from what seems like a simple enough question, geometrically speaking. Okay. Imagine a sphere in three dimensions. How many points, integer coordinate points, you know, lattice points, lie inside it or right on its surface? Right. Okay. I can picture that. Sphere centered at 0, 0, 0. And as it gets bigger, it captures more of these grid points. Precisely. And if we use N to represent the radius squared of this sphere. Oh, radius squared. Okay. Then there's this count, let's call it AN for now, which is the number of integer triples, IJK, such that I squared plus J squared plus K squared is less than or equal to N. A00023 is related to this AN. Got it. I plus J plus Ko N, that's the condition. Now, on the other hand, you could just calculate the sphere's volume. Forget the integer points for a second, just the smooth, continuous volume. The same formula, right. Yeah. VN equals 43 times the radius cubed. Since N is radius squared, the radius is N. So the volume is 43 times N to the power of 32. Okay. So AN is the discrete count. VN is the continuous volume. And the interesting part is how they relate, or maybe how they don't quite match up. That's exactly it. We define this difference, PNN, is AN minus VN. The count minus the volume. Right. Think of it as the error or the discrepancy you get if you try to approximate the number of lattice points just by using the sphere's volume. And this sequence, A00023, tells us something about this error, PN. It tells us about the extremes of this error. There's another sequence, A00092, that lists the N values where the absolute value of PN, so AN, VN, hits a new record high. Ah, okay. So A00092 finds the N where the error is biggest so far. And A00023, the sequence for today, gives us the value of PN, well, probably the nearest integer to PN for those record-setting values found in A00092. I see. The first few terms are 3, 7, 10, 19. So these are the sizes of those record errors, more or less. Exactly. And our mission, if you like, for this deep dive is to unpack this relationship. You know, the discrete points versus the continuous volume for a sphere, and why this difference, this PN, is actually quite significant in number theory. This whole idea, comparing a point count to a continuous area or volume, it sounds a bit familiar. Isn't there something called the Gauss Circle Problem? Ah, yes, absolutely. That's the classic two-dimensional analog. Well, it gets right. Sources like Wikipedia, and I think it came up in that Reddit thread too, mention it. So instead of a sphere, it's a circle in 2D. Right. You count the integer points, IHA, such that I time N plus J is less than or equal to the radius squared, let's say R, call that count NR. And you compare it to the circle's area, R. Exactly. NR is approximately MR. Again, it's not perfect. There's an error term, ER, so NR plus ER. And finding out how big that ER gets is. Well, it's a whole thing in itself, isn't it? I remember seeing something about the exponents. It is a major problem. We know the error ER grows slower than the area. It's bounded by something like C times R to the power of T. Finding the true value of this exponent T is famously difficult. Wikipedia mentions it's somewhere between 12 and 131208, something like that. That's right. Approximately 0.63. So definitely less than 1, meaning the relative error shrinks. But pinning down the exact rate is hard. So even in 2D, the grid points don't perfectly fill the shape, volume-wise. Precisely. And our 3D sphere problem with AN and VN is just the next step up. Same fundamental question. How well does the smooth volume approximate the jagged count of integer points? Which means RPN, the ANVN, is basically the 3D version of that error term ER. That's a perfect way to think about it. PN is the error term for the sphere. And the OEIS page for A00023 actually shows some Mathematica code for calculating it. It does, yeah. It gives a practical way to compute PNs. It sums up a function called squares R3, K for K going from 0 up to N. Squares R3, K, what's that? That function counts the number of ways you can write the integer K as a sum of three squares, including order and signs of the roots. Ah, so it's directly counting the lattice points on shells of radius. Essentially, yes. You sum those counts up for all shells up to radius N, which gives you the total count AN. Then the code subtracts the rounded volume VN, and voila, you have PN. So you can actually compute the error directly if you can compute the sums of squares representations. Right. But of course, number theorists want more than just computation for specific N. They want to understand the asymptotic behavior. How does this error PN grow as N gets really, really large? And that's where the bounds come in, like for the circle problem. Exactly. People often use RX for the remainder term where X is RN. So AX 43, X 32, plus RX. The goal is to find how fast RX grows. Okay, so what do we know about RX? Well, one of the foundational results mentioned in the lattice points in a sphere paper is from Walthus. He showed that RX is OX 12. Big O notation, meaning it grows no faster than some constant times the square root of X as X goes to infinity. Correct. It gives an upper limit on the growth rate. Has that been improved? Like the circle problem bounds were refined? Yes, significantly. Vinogradov later showed RX is OX 34, log X. That logarithmic factor is minor compared to the change in the exponent from 12. Oh, wait, my apologies. Walthus' result was actually better. It was OX 23. Vinogradov improved that to something slightly better involving logarithms. But the best known bound is actually OX 2132 plus A by Heath Brown. There were earlier, perhaps easier to prove but weaker bounds mentioned too, like OX 43 or even OX 1 plus A, which are much simpler estimates. Okay, so the goal is always to push that exponent down to show the error grows as slowly as possible relative to the main volume term. That's the game. A smaller exponent means the lattice points are, in a sense, more uniformly distributed and the volume is a better approximation sooner. And RPN is just this RN. It is the remainder term we're trying to bound. Precisely. R00223 tracks the extreme values of this very remainder term. It's fascinating how it connects. Now, you mentioned higher dimensions. The Reddit discussion touched on generalizing this. It did, yeah. Someone proposed a recursive way to think about it. Yeah. Let SDR be the count in D dimensions for radius R. Okay. They suggested you could get the count in N plus 1 dimensions, SN plus 1R, by taking the count in N dimensions, SNR, and adding contributions from layers. Specifically, adding twice the sum for K from 1 to floor of SDRK. Hmm. That looks like you're slicing the N plus 1 dimensional sphere and summing up counts in the N dimensional slices. That's the idea behind it. It gives a way to relate dimensions, but computationally. It looks like it would get really messy really fast. Absolutely. Finding closed forms or even good error bounds gets exponentially harder as the dimension D increases. The geometry gets much more complex. Yeah, I can imagine. It seems like we need different tools for these harder problems. You mentioned another paper, Lattice Point Counting and Harmonic Analysis. That sounds like a different angle. It is. Harmonic analysis, think Fourier analysis and related techniques, provides a powerful lens. They frame the general problem as counting points NR in a scaled region RB. R is the scaling factor. B is the basic shape, like R sphere. Right. And the error is, again, ERNR, Vol B, where D is the dimension. Okay. Harmonic analysis tries to find the error exponent, often called theta D, theta by E 20 by 8 20 by 90, which is the smallest alpha such that ER is O. It characterizes the true growth rate of the error. So what does this approach tell us about our 3D sphere case, about D? Well, the paper mentions that even a fairly basic harmonic analysis approach using smoothing functions can show that ER is less than or equal to 1. This corresponds to RX being OX1 plus E, which is weaker than the best known bounds but derived through these analytic methods. Getting the better bounds often involves... Well, it gets complicated. The paper mentioned exponential sums. Yes, that's key. The error term isn't smooth. It oscillates. These oscillations are captured by exponential sums that arise from the Fourier analysis of the lattice points. Like summing up complex exponentials. Exactly. Getting good bounds on the error term relies heavily on showing that there's significant cancellation in these sums

---
*This episode was generated from the Intellectually Curious Podcast. For more episodes, visit our [main site](https://intellectuallycurious.buzzsprout.com).*
