# OEIS A000255 Eulers Permutation Sequence

**Published:** June 20, 2025  
**Duration:** 12m 52s  
**Episode ID:** 17693025

ðŸŽ§ **[Listen to this episode](https://intellectuallycurious.buzzsprout.com/2529712/episodes/17693025-oeis-a000255-eulers-permutation-sequence)**

## Description

Learn about OEIS A000255 Eulers Permutation Sequence

## Transcript

Welcome to the Deep Dive. Really glad you could join us again. This is our ongoing series exploring the, well, the amazing online encyclopedia of integer sequences. It's tailored specifically for you, our number theory students. So today we're diving into a really neat one, OEIS A000255. You might know it as Euler's permutation sequence. And our mission today isn't, you know, just to list numbers. We want to try and uncover the story behind it. The history, some surprising connections, the elegant mathematical structures that pop up. To get us started, think about this. Picture a party, right? Everyone throws their hat in a pile in the middle of the room. They get mixed up, handed back totally at random. Now here's the captivating question. What's the probability that absolutely no one gets their own hat back? It sounds simple, maybe, but this hat problem, it's actually a classic gateway into understanding something called derangements. And I'm thrilled to be joined today by, well, a brilliant mind, a Fields Medal winning mathematician, to help us navigate all of this. That hat problem is, yeah, a perfect starting point. It's a classic combinatorial puzzle. And it leads us right into the heart of today's sequence. So our mission, as you said, is pretty clear. We'll first unpack this idea of derangements. And then we'll see exactly how OEIS A000255, Euler's permutation sequence, is, well, deeply and beautifully connected. It offers some really unique perspectives. Fantastic. So, okay, to lay the groundwork for A000255, let's start there. Derangements. What exactly are they? How do we even begin to count them? Absolutely. So at its core, a derangement is just a permutation of a set of items. Think numbers, letters, hats, where no single item ends up back in its original position. So in our hat problem, it's exactly the number of ways that nobody gets their own hat. We can look at some small examples. Maybe it helps to make it concrete. We usually use Bn for the number of derangements of n things. So for n1, just one person, one hat. Well, there's no way to derange it, right? The hat has to go back to its owner. So B1 is zero. Right, makes sense. For n2, say hats 1, 2. Only way nobody gets their own hat is if they swap. So there's just one derangement, B2, 1. For n3, hats 1, 2, 3. Now it gets a bit more interesting. The possibilities are 2, 3, 1, 3, 1, 2. Those are the only two where no number is in its original spot. So B3, 2. I see the pattern starting. Yeah, it goes quickly. B4 is 9, B5 is 44, B6 jumps to 265. These numbers are actually famous in their own right, sometimes called subfactorials or uncontrature numbers. And you can find them listed in the OEIS as A000166. Wow, 44 derangements for just five items. That's quite a leap. Yeah. So is there like a formula? How do we calculate these without listing them all out? There is. And what's fascinating is how elegantly they're generated. We can compute Bn using a really neat recurrence relation. Bn, Bn1 plus Bn2. This works for n greater than or equal to 3. And you just need those base cases we found, B1 is 0 and B2 is 1. Okay, Bn n1, Bn n1 plus Bn2. That looks interesting. Is there an intuitive way to understand why that formula works? Yes, absolutely. There's a nice combinatorial argument. Let's think about our n people and their hats again. Pick one person. Let's call her Alice. Alice definitely doesn't get her own hat back in a derangement. So she must receive someone else's hat. There are n1 choices for whose hat she gets. Let's just say she gets Bob's hat. Okay, Alice gets Bob's hat. Right. Now, we have to consider Bob. Two things could happen with Bob. Case one, Bob gets Alice's hat. So Alice and Bob just swap hats. They've taken care of each other. Now, the remaining n2 people also need to be deranged. None of them can get their own hat. The number of ways to do that is Bn2. And since there were n1 initial choices for whose hat Alice could have taken, Bob's, Carol's, etc., this whole case accounts for n1 Bn2 possibilities. I follow. Alice picks one of n1 hats, say Bob's. If Bob takes Alice's, the rest must be deranged. Makes sense. Exactly. Now, case two. Bob does not get Alice's hat. This is slightly trickier. Think of it like this. Bob still needs a hat, but it can't be his own and it can't be Alice's since Alice already has Bob's. It's kind of like we temporarily pretend Bob's original hat is Alice's hat for the purpose of this step. We now have n1 people, everyone except Alice, and n1 hats, all except Bob's original hat, which Alice has. We need to arrange these n1 items so no one gets their assigned hat, including Bold not getting the hat we've labeled as Alice's. This situation perfectly matches the definition of Bn1 derangements for n1 items. Ah, okay. So we're essentially forcing a derangement on the remaining n1 people, treating Bob as if his forbidden hat is Alice's. Precisely. Again, since Alice had n1 initial choices for whose hat to take, this case contributes n1 Bn1 possibilities. You add those two cases together, case one and case two, and you get n1 Bn2 plus n1 Bn1, which is exactly n1 Bn1 plus Bn2. That's the recurrence. That's a really clear explanation. Thank you. And what's also quite remarkable, there's another simpler-looking recurrence relation. Bn, Bm-1 plus n1n. Also for n-3. So n Bn1 plus next1n. That looks very different. How did that come about? It arises from a slightly different way of thinking about building the derangements, often involving the principle of inclusion-exclusion, actually. You mentioned inclusion-exclusion earlier. That's the more general method. Exactly. Inclusion-exclusion is really the bedrock principle here. It lets you derive the explicit formula for derangements, which is Bnn times the sum 10, m11 plus 12, 13 plus n plus minus 1n. Okay, that's the full formula. n times that alternating sum of inverse factorials. Yes. And this formula leads directly to that fascinating probability result we touched on. If you calculate the probability of a derangement, Pnn, this is Bnn, you just get that sum. 10, 11 plus plus, next1nn. As n gets large, this sum is the Taylor series expansion for 1n. So the probability converges to 1e. Which is about 0.368 or 36.8%. So for a large party, the chance that nobody gets their own hat back stabilizes around 37%. That's still kind of mind-bending to me. It is, isn't it? A fundamental constant emerging from such a simple setup. Okay, so that's derangements, A000166. Now let's bring in the star of today's show, A000255, Euler's permutation sequence. Let me list the first few terms again. A01, A1, A23, A3, A1n plus n1, A5, 309. Clearly different numbers. And you mentioned its recurrence is An, An1 plus n1, An2. Similar structure to the first arrangement one, but slightly different coefficients. So what are these numbers counting? What's the story here? Right, that's the key question. What combinatorial object corresponds to An? Well, one important interpretation, which goes back to Euler himself, is that An counts the number of permutations of n plus 2 elements that have no fixed points. So they are derangements, and they also start with the element 2. Okay, wait, derangements of n plus 2 things, specifically starting with 2. Exactly. So, for example, let's take n2. The sequence value is A2. This means there are three derangements of the set 1, 2, 3, 4 that begin with 2, and those are precisely 2, 1, 4, 3, 2, 3, 4, 1, and 2, 4, 1, 3. If you check, none of the numbers are in their original positions. 1 is in first, 2 is in second, etc., and they all start with 2. I see, that's a very specific condition, starting with 2. It is, and it connects to something called Euler's difference table, which is a way of organizing information about permutations. A000255 actually appears as the second column in a specific version of this table. It signifies its importance in that combinatorial framework. But perhaps the most revealing thing is how A000255 relates back to the derangement numbers, A000166. There are actually two very neat connections. Oh, okay. First, there's a simple additive relationship. An is just the sum of two consecutive derangement numbers, specifically An, A000166, n plus A000166, 2, 3. So 1 plus 2 equals 3. It works. It does. It holds generally. So Euler's sequence term is built directly from two adjacent derangement terms

---
*This episode was generated from the Intellectually Curious Podcast. For more episodes, visit our [main site](https://intellectuallycurious.buzzsprout.com).*
